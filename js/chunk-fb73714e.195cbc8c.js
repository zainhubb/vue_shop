(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-fb73714e"],{"0953":function(e,t,r){"use strict";r.d(t,"f",(function(){return s})),r.d(t,"i",(function(){return i})),r.d(t,"h",(function(){return o})),r.d(t,"a",(function(){return n})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return u})),r.d(t,"g",(function(){return c})),r.d(t,"e",(function(){return d})),r.d(t,"c",(function(){return m}));r("99af");var a=r("0f27");function s(){return Object(a["a"])({url:"/rights/list",method:"get"})}function i(){return Object(a["a"])({url:"/roles",method:"get"})}function o(e){return Object(a["a"])({url:"/roles/"+e,method:"get"})}function n(e){return Object(a["a"])({url:"/roles",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/roles/"+e,method:"delete"})}function u(e,t){return Object(a["a"])({url:"roles/".concat(e,"/rights"),method:"post",data:t})}function c(){return Object(a["a"])({url:"/rights/tree",method:"get"})}function d(e,t){return Object(a["a"])({url:"/roles/"+e,method:"put",data:t})}function m(e,t){return Object(a["a"])({url:"roles/".concat(e,"/rights/").concat(t),method:"delete"})}},"7d9c":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("用户管理")]),r("el-breadcrumb-item",[e._v("用户列表")])],1),r("el-row",{attrs:{gutter:25}},[r("el-col",{attrs:{span:8}},[r("el-input",{attrs:{placeholder:"请输入内容",clearable:!0},on:{clear:e.getUserlist},model:{value:e.queryinfo.query,callback:function(t){e.$set(e.queryinfo,"query",t)},expression:"queryinfo.query"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserlist},slot:"append"})],1)],1),r("el-col",{attrs:{span:5}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.adddialogVisible=!0}}},[e._v("添加用户")])],1)],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.usersinfo,border:!0,stripe:!0}},[r("el-table-column",{attrs:{type:"index",label:"#",align:"center"}}),r("el-table-column",{attrs:{prop:"username",label:"姓名",align:"center"}}),r("el-table-column",{attrs:{prop:"mobile",label:"电话",align:"center"}}),r("el-table-column",{attrs:{prop:"email",label:"邮箱",align:"center"}}),r("el-table-column",{attrs:{prop:"role_name",label:"角色",align:"center"}}),r("el-table-column",{attrs:{prop:"mg_state",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{attrs:{"active-color":"#67C23A","inactive-color":"#909399"},model:{value:t.row.mg_state,callback:function(r){e.$set(t.row,"mg_state",r)},expression:"scope.row.mg_state"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"125px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{staticClass:"item",attrs:{content:"编辑",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",circle:""},on:{click:function(r){return e.showeditdialog(t.row.id)}}})],1),r("el-tooltip",{staticClass:"item",attrs:{content:"分配角色",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini",circle:""},on:{click:function(r){return e.showsetroledialog(t.row)}}})],1),r("el-tooltip",{staticClass:"item",attrs:{content:"删除",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",circle:""},on:{click:function(r){return e.removeuserbyid(t.row.id)}}})],1)]}}])})],1),r("el-pagination",{attrs:{"current-page":e.queryinfo.pagenum,"page-sizes":[1,2,5,10],"page-size":e.queryinfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:"添加用户",visible:e.adddialogVisible,width:"45%"},on:{"update:visible":function(t){e.adddialogVisible=t},close:e.resetadd}},[r("el-form",{ref:"adduserFormRef",attrs:{model:e.adduserForm,rules:e.addRules,"label-width":"70px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{model:{value:e.adduserForm.username,callback:function(t){e.$set(e.adduserForm,"username",t)},expression:"adduserForm.username"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password"},model:{value:e.adduserForm.password,callback:function(t){e.$set(e.adduserForm,"password",t)},expression:"adduserForm.password"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.adduserForm.email,callback:function(t){e.$set(e.adduserForm,"email",t)},expression:"adduserForm.email"}})],1),r("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[r("el-input",{model:{value:e.adduserForm.mobile,callback:function(t){e.$set(e.adduserForm,"mobile",t)},expression:"adduserForm.mobile"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.adddialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.adduser}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"编辑用户",visible:e.editdialogVisible,width:"45%"},on:{"update:visible":function(t){e.editdialogVisible=t}}},[r("el-form",{ref:"edituserFormRef",attrs:{model:e.edituserForm,rules:e.addRules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{disabled:""},model:{value:e.edituserForm.username,callback:function(t){e.$set(e.edituserForm,"username",t)},expression:"edituserForm.username"}})],1),r("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[r("el-input",{model:{value:e.edituserForm.mobile,callback:function(t){e.$set(e.edituserForm,"mobile",t)},expression:"edituserForm.mobile"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.edituserForm.email,callback:function(t){e.$set(e.edituserForm,"email",t)},expression:"edituserForm.email"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editdialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.edituserinfo}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"分配角色",visible:e.setroledialogVisible,width:"45%"},on:{"update:visible":function(t){e.setroledialogVisible=t},close:e.resetsetrole}},[r("div",[r("p",[e._v("当前用户:"+e._s(this.userinfo.username))]),r("p",[e._v("当前角色:"+e._s(this.userinfo.role_name))]),r("p",[e._v(" 分配新角色: "),r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectedrole,callback:function(t){e.selectedrole=t},expression:"selectedrole"}},e._l(e.roleslist,(function(e){return r("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)]),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.setroledialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.setrole}},[e._v("确 定")])],1)])],1)},s=[],i=(r("96cf"),r("1da1")),o=r("0f27");function n(e){return Object(o["a"])({url:"/users",params:e})}function l(e,t){return Object(o["a"])({url:"/users/".concat(e,"/role"),method:"put",data:t})}function u(e){return Object(o["a"])({url:"/users/"+e,method:"delete"})}function c(e){return Object(o["a"])({url:"/users/"+e,method:"get"})}function d(e){return Object(o["a"])({url:"/users",method:"post",data:e})}function m(e,t){return Object(o["a"])({url:"/users/"+e,method:"put",data:t})}var f=r("0953"),p={data:function(){var e=function(e,t,r){var a=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+\.([a-zA-Z0-9_-])+$/;if(a.test(t))return r();r(new Error("请输入正确邮箱"))},t=function(e,t,r){var a=/^1([3-9])\d{9}$/;if(a.test(t))return r();r(new Error("请输入正确手机号"))};return{queryinfo:{query:"",pagenum:1,pagesize:2},usersinfo:[],total:0,adddialogVisible:!1,editdialogVisible:!1,setroledialogVisible:!1,adduserForm:{username:"",password:"",email:"",mobile:""},addRules:{username:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:6,message:"长度在 3 到 5 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"长度在 6 到 10 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",tigger:"blur"},{validator:e,tigger:"blur"}],mobile:[{required:!0,message:"请输入手机",tigger:"blur"},{validator:t,tigger:"blur"}]},edituserForm:{},userinfo:{},roleslist:[],selectedrole:""}},created:function(){this.getUserlist()},methods:{getUserlist:function(){var e=this;n(this.queryinfo).then((function(t){if(200!==t.data.meta.status)return e.$message({message:"获取用户列表失败",type:"error"});e.usersinfo=t.data.data.users,e.total=t.data.data.total}))},handleCurrentChange:function(e){this.queryinfo.pagenum=e,this.getUserlist()},handleSizeChange:function(e){this.queryinfo.pagesize=e,this.getUserlist()},resetadd:function(){this.$refs.adduserFormRef.resetFields()},adduser:function(){var e=this;this.$refs.adduserFormRef.validate((function(t){t&&d(e.adduserForm).then((function(t){if(201!==t.data.meta.status)return e.$message({message:"添加用户失败!",type:"error"});e.getUserlist(),e.adddialogVisible=!1,e.$message({message:"添加用户成功!",type:"success"})}))}))},showeditdialog:function(e){var t=this;c(e).then((function(e){if(200!==e.data.meta.status)return t.$message.error("获取用户信息失败");t.edituserForm=e.data.data,t.editdialogVisible=!0}))},edituserinfo:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.edituserFormRef.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:m(e.edituserForm.id,{email:e.edituserForm.email,mobile:e.edituserForm.mobile}).then((function(t){if(200!==t.data.meta.status)return e.$message.error("修改失败!");e.editdialogVisible=!1,e.getUserlist(),e.$message.success("修改成功!")}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},removeuserbyid:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 2:if(a=r.sent,"confirm"===a){r.next=5;break}return r.abrupt("return",t.$message.info("取消删除"));case 5:u(e).then((function(e){if(200!==e.data.meta.status)return t.$message.error("删除失败!");t.$message.success("删除成功!"),t.getUserlist()}));case 6:case"end":return r.stop()}}),r)})))()},showsetroledialog:function(e){var t=this;this.userinfo=e,Object(f["i"])().then((function(e){if(200!==e.data.meta.status)return t.$message.error("获取角色列表失败!");t.roleslist=e.data.data,t.setroledialogVisible=!0}))},setrole:function(e){var t=this;if(!this.selectedrole)return this.$message.error("请选择一个角色!");l(this.userinfo.id,{rid:this.selectedrole}).then((function(e){return 200!==e.data.meta.status?t.$message.error("更新用户角色失败!"):(t.getUserlist(),t.setroledialogVisible=!1,t.$message.success("更新用户角色成功!"))}))},resetsetrole:function(){this.selectedrole=""}}},b=p,g=r("2877"),h=Object(g["a"])(b,a,s,!1,null,"56a0b8bb",null);t["default"]=h.exports}}]);
//# sourceMappingURL=chunk-fb73714e.195cbc8c.js.map